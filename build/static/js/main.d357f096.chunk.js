(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{37:function(e,t,n){e.exports=n(73)},72:function(e,t,n){},73:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),u=n(19),c=n.n(u),i=n(3),o=n(1),s=n.n(o),l=n(2),d=n(5),f=function(e){return function(t){t({type:"NEW_NOTIFICATION",content:e}),setTimeout(function(){t({type:"CLEAR_NOTIFICATION"})},5e3)}},m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_NOTIFICATION":return t.content;case"CLEAR_NOTIFICATION":return null;default:return e}},p=n(13),h=n(6),v=n.n(h),E="/api/threads",b=null,w={getAll:function(){return v.a.get(E).then(function(e){return e.data})},create:function(){var e=Object(l.a)(s.a.mark(function e(t){var n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===b){e.next=6;break}return n={headers:{Authorization:b}},e.next=4,v.a.post(E,t,n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),update:function(e){if(null!==b){var t={headers:{Authorization:b}};return v.a.put("".concat(E,"/").concat(e.id),e,t).then(function(e){return e.data})}return null},removeThread:function(e){if(null!==b){var t={headers:{Authorization:b}};return v.a.delete("".concat(E,"/").concat(e),t).then(function(e){return e.data})}return null},setToken:function(e){b="bearer ".concat(e)},removeToken:function(){b=null}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_THREAD":return[].concat(Object(p.a)(e),[t.data]);case"INITIALIZE_THREADS":return t.data;case"EDIT_THREAD":var n=e.findIndex(function(e){return e.id===t.data.id}),r=Object(p.a)(e);return r[n]=t.data,r;case"DELETE_THREAD":return e.filter(function(e){return e.id!==t.data});default:return e}},g={setNotification:f,addThread:function(e){return function(){var t=Object(l.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.create(e);case 2:r=t.sent,n({type:"NEW_THREAD",data:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}},y=Object(i.b)(function(e){return{user:e.user}},g)(function(e){console.log("props",e);var t=Object(r.useState)(""),n=Object(d.a)(t,2),u=n[0],c=n[1],i=Object(r.useState)(""),o=Object(d.a)(i,2),f=o[0],m=o[1],p=function(){var t=Object(l.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),r={title:u,message:f,date:(new Date).toISOString(),userId:e.findUserIdByUsername(e.user.username).id},console.log("threadobject",r),c(""),m(""),e.addThread(r),e.setNotification("New thread added");case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement("h3",null,"Add new thread"),a.a.createElement("form",{onSubmit:p},a.a.createElement("div",null,"title:",a.a.createElement("input",{value:u,onChange:function(e){c(e.target.value)}})),a.a.createElement("div",null,"message:",a.a.createElement("input",{value:f,onChange:function(e){m(e.target.value)}})),a.a.createElement("button",{type:"submit"},"add")))}),j=n(15),T={login:function(){var e=Object(l.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/api/login",t);case 2:return n=e.sent,console.log("response",n),e.abrupt("return",n.data);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},I=null,x={getAll:function(){return v.a.get("/api/comments").then(function(e){return e.data})},create:function(){var e=Object(l.a)(s.a.mark(function e(t){var n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===I){e.next=6;break}return n={headers:{Authorization:I}},e.next=4,v.a.post("/api/comments",t,n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){I="bearer ".concat(e)},removeToken:function(){I=null},update:function(){var e=Object(l.a)(s.a.mark(function e(t){var n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===I){e.next=6;break}return n={headers:{Authorization:I}},e.next=4,v.a.put("".concat("/api/comments","/").concat(t.id),t,n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),removeComment:function(){var e=Object(l.a)(s.a.mark(function e(t){var n,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null===I){e.next=6;break}return n={headers:{Authorization:I}},e.next=4,v.a.delete("".concat("/api/comments","/").concat(t),n);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.data;case"LOGOUT":return null;default:return e}},k={setNotification:f,login:function(e){return function(){var t=Object(l.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T.login(e);case 2:r=t.sent,window.localStorage.setItem("Campus24User",JSON.stringify(r)),w.setToken(e.token),x.setToken(e.token),n({type:"LOGIN",data:r});case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}},C=Object(i.b)(function(e){return{user:e.user}},k)(function(e){if(null!==e.user)return a.a.createElement("div",null,a.a.createElement(j.a,{to:"/"}));var t=Object(r.useState)(""),n=Object(d.a)(t,2),u=n[0],c=n[1],i=Object(r.useState)(""),o=Object(d.a)(i,2),f=o[0],m=o[1],p=function(){var t=Object(l.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r={username:u,password:f},t.next=4,e.login(r);case 4:e.setNotification("Welcome!");case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement("h2",null,"Login"),a.a.createElement("form",{onSubmit:p},a.a.createElement("div",null,"username",a.a.createElement("input",{type:"text",value:u,name:"Username",onChange:function(e){c(e.target.value)}})),a.a.createElement("div",null,"password",a.a.createElement("input",{type:"password",value:f,name:"Password",onChange:function(e){m(e.target.value)}})),a.a.createElement("div",null,a.a.createElement("button",{type:"submit"},"login"))))}),A={getAll:function(){return v.a.get("/api/users").then(function(e){return e.data})},create:function(){var e=Object(l.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.post("/api/users",t);case 3:return n=e.sent,e.abrupt("return",n.data);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(t){return e.apply(this,arguments)}}()},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_USER":return[].concat(Object(p.a)(e),[t.data]);case"INITIALIZE_USERS":return t.data;default:return e}},U={addUser:function(e){return function(){var t=Object(l.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.create(e);case 2:r=t.sent,n({type:"NEW_USER",data:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},setNotification:f},_=Object(i.b)(function(e){return{user:e.user}},U)(function(e){if(null!==e.user)return a.a.createElement("div",null,a.a.createElement(j.a,{to:"/"}));var t=Object(r.useState)(""),n=Object(d.a)(t,2),u=n[0],c=n[1],i=Object(r.useState)(""),o=Object(d.a)(i,2),f=o[0],m=o[1],p=Object(r.useState)(""),h=Object(d.a)(p,2),v=h[0],E=h[1],b=function(){var t=Object(l.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n.preventDefault(),r={name:f,username:u,password:v},e.addUser(r),e.setNotification("New user added!"),m(""),E(""),c("");case 7:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement("h3",null,"Create new user"),a.a.createElement("form",{onSubmit:b},a.a.createElement("div",null,"username",a.a.createElement("input",{type:"text",value:u,name:"newUsername",onChange:function(e){c(e.target.value)}})),a.a.createElement("div",null,"name",a.a.createElement("input",{type:"text",value:f,name:"newName",onChange:function(e){m(e.target.value)}})),a.a.createElement("div",null,"password",a.a.createElement("input",{type:"password",value:v,name:"newPassword",onChange:function(e){E(e.target.value)}})),a.a.createElement("button",{type:"submit"},"Add a new user")))}),D=Object(i.b)(function(e){return{notification:e.notification}},null)(function(e){return null===e.notification||""===e.notification?null:a.a.createElement("div",{className:"notification"},e.notification)}),L=n(7),M=Object(i.b)(function(e){return{threads:e.threads,comments:e.comments,users:e.users,user:e.user}},null)(function(e){return a.a.createElement("div",null,a.a.createElement("h2",null,"Threads"),e.threads.map(function(e){return a.a.createElement("li",{key:e.id},a.a.createElement(L.b,{key:e.id,to:"/threads/".concat(e.id)}," ",e.title," "))}))}),R={logout:function(){return function(){var e=Object(l.a)(s.a.mark(function e(t){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.clear(),w.removeToken(),x.removeToken(),t({type:"LOGOUT"});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},setNotification:f},z=Object(i.b)(function(e){return{user:e.user}},R)(function(e){if(null===e.user)return a.a.createElement("div",null,a.a.createElement(j.a,{to:"/"}));return a.a.createElement("div",null,a.a.createElement("h3",null,"Logout"),a.a.createElement("button",{onClick:function(){return e.logout(),void e.setNotification("See you soon!")}},"logout"))}),W=n(36),H=function(e){var t,n=(t=e.id,e.allComments.find(function(e){return e.id===t}));return void 0!==n?a.a.createElement("div",null,a.a.createElement("p",null,"Message: ",n.message),a.a.createElement("p",null,"Author: ",n.user.username," Date: ",n.date)):""},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_COMMENT":return[].concat(Object(p.a)(e),[t.data]);case"INITIALIZE_COMMENTS":return t.data;case"EDIT_COMMENT":var n=e.findIndex(function(e){return e.id===t.data.id}),r=Object(p.a)(e);return r[n]=t.data,r;case"DELETE_COMMENT":return e.filter(function(e){return e.id!==t.data});default:return e}},Z={setNotification:f,addComment:function(e){return function(){var t=Object(l.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.create(e);case 2:r=t.sent,n({type:"NEW_COMMENT",data:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}},G=Object(i.b)(function(e){return{notification:e.notification,threads:e.threads,comments:e.comments,users:e.users,user:e.user}},Z)(function(e){var t=Object(r.useState)(""),n=Object(d.a)(t,2),u=n[0],c=n[1],i=function(){var t=Object(l.a)(s.a.mark(function t(){var n;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n={message:u,date:(new Date).toISOString(),userId:e.findUserIdByUsername(e.user.username).id,threadId:e.threadId},e.addComment(n),e.setNotification("New comment added");case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}();return a.a.createElement("div",null,a.a.createElement("h4",null,"Add new comment"),a.a.createElement("form",null,a.a.createElement("div",null,"message:",a.a.createElement("input",{value:u,onChange:function(e){c(e.target.value)}})),a.a.createElement("button",{onClick:function(){return i()}},"add")))}),F={deleteThread:function(e){return function(){var t=Object(l.a)(s.a.mark(function t(n){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.removeThread(e);case 2:n({type:"DELETE_THREAD",data:e});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},editThread:function(e){return function(){var t=Object(l.a)(s.a.mark(function t(n){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.update(e);case 2:r=t.sent,n({type:"EDIT_THREAD",data:r});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()},setNotification:f},J=Object(i.b)(function(e){return{notification:e.notification,threads:e.threads,comments:e.comments,users:e.users,user:e.user}},F)(function(e){var t=Object(r.useState)(!1),n=Object(d.a)(t,2),u=n[0],c=n[1],i=Object(r.useState)(""),o=Object(d.a)(i,2),f=o[0],m=o[1],p=function(e){m(e.target.value)};if(u)return a.a.createElement("div",null,a.a.createElement(j.a,{to:"/"}));if(void 0===e.thread)return null;var h=function(){var t=Object(l.a)(s.a.mark(function t(n){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.deleteThread(n),e.setNotification("Thread deleted"),c(!0);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),v=function(){var t=Object(l.a)(s.a.mark(function t(n){var r,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=e.threads.find(function(e){return e.id===n}),a=Object(W.a)({},r,{message:f}),e.editThread(a),e.setNotification("Thread edited");case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();if(null===e.user)return a.a.createElement("div",null,a.a.createElement("h3",null,e.thread.title),a.a.createElement("h4",null,"Comments:"),e.thread.comments.map(function(t){return a.a.createElement(H,{key:t,id:t,allComments:e.comments})}));var E=!1;void 0!==e.thread.user.username?e.thread.user.username===e.user.username&&(E=!0):e.users.find(function(t){return t.id===e.thread.user}).username===e.user.username&&(E=!0);return a.a.createElement("div",null,a.a.createElement("h3",null,e.thread.title),a.a.createElement("h4",null,"Message: ",e.thread.message),"Author: ",e.thread.user.username,E&&a.a.createElement("div",null,a.a.createElement("form",null,a.a.createElement("div",null,"new message",a.a.createElement("input",{value:f,onChange:p})),a.a.createElement("button",{onClick:function(){return v(e.thread.id,f)}}," edit ")),a.a.createElement("button",{onClick:function(){return h(e.thread.id)}}," delete ")),a.a.createElement("h4",null,"Comments:"),e.thread.comments.map(function(t){return a.a.createElement(H,{key:t,id:t,allComments:e.comments})}),a.a.createElement(G,{findUserIdByUsername:e.findUserIdByUsername,threadId:e.thread.id}))}),P=(n(72),{initializeThreads:function(){return function(){var e=Object(l.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.getAll();case 2:n=e.sent,t({type:"INITIALIZE_THREADS",data:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},initializeComments:function(){return function(){var e=Object(l.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.getAll();case 2:n=e.sent,t({type:"INITIALIZE_COMMENTS",data:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},initializeUsers:function(){return function(){var e=Object(l.a)(s.a.mark(function e(t){var n;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.getAll();case 2:n=e.sent,t({type:"INITIALIZE_USERS",data:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},setUser:function(e){return function(){var t=Object(l.a)(s.a.mark(function t(n){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:w.setToken(e.token),x.setToken(e.token),n({type:"LOGIN",data:e});case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()}}),q=Object(i.b)(function(e){return{notification:e.notification,threads:e.threads,comments:e.comments,users:e.users,user:e.user}},P)(function(e){Object(r.useEffect)(function(){e.initializeThreads(),e.initializeComments(),e.initializeUsers();var t=window.localStorage.getItem("Campus24User");if(t){var n=JSON.parse(t);e.setUser(n)}},[]);var t=function(t){return e.users.find(function(e){return e.username===t})},n={padding:5};return a.a.createElement("div",null,a.a.createElement(L.a,null,a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement(L.b,{style:n,to:"/"},"Threads"),null===e.user&&a.a.createElement(L.b,{style:n,to:"/login"},"Login"),null===e.user&&a.a.createElement(L.b,{style:n,to:"/create"},"Create new user"),null!==e.user&&a.a.createElement(L.b,{style:n,to:"/logout"},"Logout"),null!==e.user&&a.a.createElement(L.b,{style:n,to:"/addNewThread"},"Add a new thread"),null!==e.notification&&a.a.createElement(D,null)),a.a.createElement(j.b,{exact:!0,path:"/",render:function(){return a.a.createElement(M,null)}}),a.a.createElement(j.b,{exact:!0,path:"/login",render:function(){return a.a.createElement(C,null)}}),a.a.createElement(j.b,{exact:!0,path:"/create",render:function(){return a.a.createElement(_,null)}}),a.a.createElement(j.b,{exact:!0,path:"/logout",render:function(){return a.a.createElement(z,null)}}),a.a.createElement(j.b,{exact:!0,path:"/addNewThread",render:function(){return a.a.createElement(y,{findUserIdByUsername:t})}}),a.a.createElement(j.b,{exact:!0,path:"/threads/:id",render:function(n){var r,u=n.match;return a.a.createElement(J,{thread:(r=u.params.id,e.threads.find(function(e){return e.id===r})),findUserIdByUsername:t})}}))))}),K=n(14),Q=n(34),V=n(35),X=Object(K.combineReducers)({notification:m,threads:O,comments:B,users:S,user:N}),Y=Object(K.createStore)(X,Object(V.composeWithDevTools)(Object(K.applyMiddleware)(Q.a))),$=function(){c.a.render(a.a.createElement(i.a,{store:Y},a.a.createElement(q,null)),document.getElementById("root"))};$(),Y.subscribe($)}},[[37,1,2]]]);
//# sourceMappingURL=main.d357f096.chunk.js.map